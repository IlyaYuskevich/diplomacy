export enum ProvinceType {
  Coast = "COAST",
  Land = "LAND",
  Sea = "SEA",
}

export const provinces = {
  Adr: {
    name: "Adriatic Sea",
    type: ProvinceType.Sea,
  },
  Aeg: {
    name: "Aegean Sea",
    type: ProvinceType.Sea,
  },
  Alb: {
    name: "Albania",
    type: ProvinceType.Coast,
  },
  Ank: {
    name: "Ankara",
    type: ProvinceType.Coast,
  },
  Apu: {
    name: "Apulia",
    type: ProvinceType.Coast,
  },
  Arm: {
    name: "Armenia",
    type: ProvinceType.Coast,
  },
  Bar: {
    name: "Barents Sea",
    type: ProvinceType.Sea,
  },
  Bal: {
    name: "Baltic Sea",
    type: ProvinceType.Sea,
  },
  Bel: {
    name: "Belgium",
    type: ProvinceType.Coast,
  },
  Ber: {
    name: "Berlin",
    type: ProvinceType.Coast,
  },
  Bla: {
    name: "Black Sea",
    type: ProvinceType.Sea,
  },
  Boh: {
    name: "Bohemia",
    type: ProvinceType.Land,
  },
  Bot: {
    name: "Gulf of Bothnia",
    type: ProvinceType.Sea,
  },
  Bre: {
    name: "Brest",
    type: ProvinceType.Coast,
  },
  Bud: {
    name: "Budapest",
    type: ProvinceType.Land,
  },
  Bul: {
    name: "Bulgaria",
    type: ProvinceType.Coast,
  },
  BulS: {
    name: "Bulgaria South Coast",
    type: ProvinceType.Coast,
  },
  BulE: {
    name: "Bulgaria East Coast",
    type: ProvinceType.Coast,
  },
  Bur: {
    name: "Burgundy",
    type: ProvinceType.Land,
  },
  Cly: {
    name: "Clyde",
    type: ProvinceType.Coast,
  },
  Con: {
    name: "Constantinople",
    type: ProvinceType.Coast,
  },
  Den: {
    name: "Denmark",
    type: ProvinceType.Coast,
  },
  Eas: {
    name: "Eastern Mediterranean",
    type: ProvinceType.Sea,
  },
  Edi: {
    name: "Edinburgh",
    type: ProvinceType.Coast,
  },
  Eng: {
    name: "English Channel",
    type: ProvinceType.Sea,
  },
  Fin: {
    name: "Finland",
    type: ProvinceType.Coast,
  },
  Gal: {
    name: "Galicia",
    type: ProvinceType.Land,
  },
  Gas: {
    name: "Gascony",
    type: ProvinceType.Coast,
  },
  Gre: {
    name: "Greece",
    type: ProvinceType.Coast,
  },
  GoL: {
    name: "Gulf of Lyon",
    type: ProvinceType.Sea,
  },
  Hol: {
    name: "Holland",
    type: ProvinceType.Coast,
  },
  Ion: {
    name: "Ionian Sea",
    type: ProvinceType.Sea,
  },
  Iri: {
    name: "Irish Sea",
    type: ProvinceType.Sea,
  },
  Kie: {
    name: "Kiel",
    type: ProvinceType.Coast,
  },
  Hel: {
    name: "Helgoland Bight",
    type: ProvinceType.Sea,
  },
  Lon: {
    name: "London",
    type: ProvinceType.Coast,
  },
  Lvn: {
    name: "Livonia",
    type: ProvinceType.Coast,
  },
  Lvp: {
    name: "Liverpool",
    type: ProvinceType.Coast,
  },
  Mar: {
    name: "Marseilles",
    type: ProvinceType.Coast,
  },
  Mid: {
    name: "Mid-Atlantic Ocean",
    type: ProvinceType.Sea,
  },
  Mos: {
    name: "Moscow",
    type: ProvinceType.Land,
  },
  Mun: {
    name: "Munich",
    type: ProvinceType.Land,
  },
  NAf: {
    name: "North Africa",
    type: ProvinceType.Coast,
  },
  Nap: {
    name: "Naples",
    type: ProvinceType.Coast,
  },
  NAt: {
    name: "North Atlantic Ocean",
    type: ProvinceType.Sea,
  },
  Nrg: {
    name: "Norwegian Sea",
    type: ProvinceType.Sea,
  },
  Nwy: {
    name: "Norway",
    type: ProvinceType.Coast,
  },
  Nth: {
    name: "North Sea",
    type: ProvinceType.Sea,
  },
  Par: {
    name: "Paris",
    type: ProvinceType.Land,
  },
  Pic: {
    name: "Picardy",
    type: ProvinceType.Coast,
  },
  Pie: {
    name: "Piedmont",
    type: ProvinceType.Coast,
  },
  Por: {
    name: "Portugal",
    type: ProvinceType.Coast,
  },
  Pru: {
    name: "Prussia",
    type: ProvinceType.Coast,
  },
  Rom: {
    name: "Rome",
    type: ProvinceType.Coast,
  },
  Ruh: {
    name: "Ruhr",
    type: ProvinceType.Land,
  },
  Rum: {
    name: "Rumania",
    type: ProvinceType.Coast,
  },
  Ser: {
    name: "Serbia",
    type: ProvinceType.Land,
  },
  Sev: {
    name: "Sevastopol",
    type: ProvinceType.Coast,
  },
  Sil: {
    name: "Silesia",
    type: ProvinceType.Land,
  },
  Ska: {
    name: "Skagerrak",
    type: ProvinceType.Sea,
  },
  Smy: {
    name: "Smyrna",
    type: ProvinceType.Coast,
  },
  Spa: {
    name: "Spain",
    type: ProvinceType.Coast,
  },
  SpaS: {
    name: "Spain South Coast",
    type: ProvinceType.Coast,
  },
  SpaN: {
    name: "Spain North Coast",
    type: ProvinceType.Coast,
  },
  StP: {
    name: "Saint Petersburg",
    type: ProvinceType.Coast,
  },
  StPN: {
    name: "Saint Petersburg North Coast",
    type: ProvinceType.Coast,
  },
  StPS: {
    name: "Saint Petersburg South Coast",
    type: ProvinceType.Coast,
  },
  Swe: {
    name: "Sweden",
    type: ProvinceType.Coast,
  },
  Syr: {
    name: "Syria",
    type: ProvinceType.Coast,
  },
  Tri: {
    name: "Trieste",
    type: ProvinceType.Coast,
  },
  Tun: {
    name: "Tunis",
    type: ProvinceType.Coast,
  },
  Tus: {
    name: "Tuscany",
    type: ProvinceType.Coast,
  },
  Tyn: {
    name: "Tyrrhenian Sea",
    type: ProvinceType.Sea,
  },
  Tyr: {
    name: "Tyrolia",
    type: ProvinceType.Land,
  },
  Ukr: {
    name: "Ukraine",
    type: ProvinceType.Land,
  },
  Ven: {
    name: "Venice",
    type: ProvinceType.Coast,
  },
  Vie: {
    name: "Vienna",
    type: ProvinceType.Land,
  },
  Wal: {
    name: "Wales",
    type: ProvinceType.Coast,
  },
  War: {
    name: "Warsaw",
    type: ProvinceType.Land,
  },
  Wes: {
    name: "Western Mediterranean",
    type: ProvinceType.Sea,
  },
  Yor: {
    name: "Yorkshire",
    type: ProvinceType.Coast,
  },
};

export type ProvinceCode = keyof typeof provinces;

export const fleetBorders: Partial<Record<ProvinceCode, ProvinceCode[]>> = {
  "Adr": ["Alb", "Apu", "Tri", "Ven", "Ion"],
  "Aeg": ["Con", "BulS", "Eas", "Gre", "Smy", "Ion"],
  "Alb": ["Adr", "Gre", "Tri", "Ion"],
  "Ank": ["Arm", "Con", "Bla"],
  "Apu": ["Adr", "Ion", "Nap", "Ven"],
  "Arm": ["Ank", "Sev", "Bla"],
  "Bal": ["Swe", "Den", "Lvn", "Kie", "Ber", "Pru", "Bot"],
  "Bar": ["Nrg", "Nwy", "StPN"],
  "Bla": ["Sev", "Rum", "BulE", "Con", "Ank", "Arm"],
  "Bel": ["Hol", "Pic", "Nth", "Eng"],
  "Ber": ["Bal", "Kie", "Pru", "Sil"],
  "Bre": ["Gas", "Eng", "Mid", "Pic"],
  "Bot": ["Fin", "Swe", "Bal", "Lvn", "StPS"],
  "BulS": ["Con", "Gre", "Aeg"],
  "BulE": ["Con", "Rum", "Bla"],
  "Cly": ["Nrg", "NAt", "Lvp", "Edi"],
  "Con": ["Aeg", "Ank", "Bla", "BulS", "BulE", "Smy"],
  "Den": ["Hel", "Bal", "Kie", "Nth", "Ska", "Swe"],
  "Eas": ["Aeg", "Ion", "Smy", "Syr"],
  "Edi": ["Cly", "Nrg", "Nth", "Yor"],
  "Eng": ["Bel", "Bre", "Pic", "Iri", "Lon", "Nth", "Mid", "Wal"],
  "Fin": ["Swe", "Bot", "StPS"],
  "Gas": ["Bre", "Mid", "SpaN"],
  "Gre": ["Alb", "Aeg", "BulS", "Ion"],
  "GoL": ["Mar", "SpaS", "Wes", "Tyn", "Tus", "Pie"],
  "Hol": ["Bel", "Eng", "Kie", "Nth"],
  "Hel": ["Nth", "Hol", "Kie", "Den"],
  "Ion": ["Gre", "Aeg", "Alb", "Adr", "Apu", "Eas", "Nap", "Tun", "Tyn"],
  "Iri": ["Eng", "Lvp", "Mid", "NAt", "Wal"],
  "Kie": ["Bal", "Ber", "Den", "Hel", "Hol"],
  "Lon": ["Eng", "Wal", "Nth", "Yor"],
  "Lvp": ["Cly", "NAt", "Iri", "Wal"],
  "Lvn": ["Bot", "StPS", "Pru"],
  "Mar": ["GoL", "Pie", "SpaS"],
  "Mid": [
    "NAt",
    "Iri",
    "Eng",
    "Bre",
    "Gas",
    "SpaN",
    "Por",
    "SpaS",
    "Wes",
    "NAf",
  ],
  "NAf": ["Tun"],
  "Nap": ["Apu", "Ion", "Tyn", "Rom"],
  "NAt": ["Cly", "Lvp", "Iri", "Mid", "Nrg"],
  "Nrg": ["Bar", "Edi", "Cly", "NAt", "Nth", "Nwy"],
  "Nwy": ["Bar", "Nrg", "Nth", "Ska", "Swe", "StPN"],
  "Nth": [
    "Bel",
    "Nrg",
    "Edi",
    "Yor",
    "Lon",
    "Eng",
    "Hol",
    "Hel",
    "Den",
    "Ska",
    "Nwy",
  ],
  "Pie": ["Mar", "Tus", "GoL"],
  "Pic": ["Bel", "Bre", "Eng"],
  "Por": ["SpaN", "SpaS", "Mid"],
  "Pru": ["Ber", "Bal", "Lvn", "War"],
  "Rom": ["Nap", "Tus", "Tyn"],
  "Rum": ["Sev", "Bla", "BulE"],
  "Sev": ["Arm", "Rum", "Bla"],
  "Smy": ["Aeg", "Con", "Eas", "Syr"],
  "SpaN": ["Gas", "Por", "Mid"],
  "SpaS": ["Mar", "Por", "Mid", "Wes", "GoL"],
  "StPS": ["Fin", "Lvn", "Bot"],
  "StPN": ["Bar", "Nwy"],
  "Ska": ["Nwy", "Nth", "Den", "Swe"],
  "Syr": ["Smy", "Eas"],
  "Swe": ["Bot", "Nwy", "Bal", "Fin", "Den", "Ska"],
  "Tri": ["Adr", "Alb", "Ven"],
  "Tun": ["Ion", "NAf", "Tyn", "Wes"],
  "Tus": ["Pie", "Rom", "Tyn", "GoL"],
  "Tyn": ["Tus", "GoL", "Wes", "Tun", "Ion", "Nap", "Rom"],
  "Ven": ["Adr", "Apu", "Tri"],
  "Wal": ["Eng", "Iri", "Lvp", "Lon"],
  "Wes": ["Mid", "NAf", "Tus", "SpaS", "Tun", "Tyn"],
  "Yor": ["Edi", "Lon", "Nth"],
};

export const armyBorders: Partial<Record<ProvinceCode, ProvinceCode[]>> = {
  "Alb": ["Gre", "Ser", "Tri"],
  "Ank": ["Arm", "Con", "Smy"],
  "Apu": ["Nap", "Ven", "Rom"],
  "Arm": ["Ank", "Sev", "Smy", "Syr"],
  "Bel": ["Bur", "Hol", "Pic", "Ruh"],
  "Ber": ["Kie", "Pru", "Sil", "Mun"],
  "Bre": ["Gas", "Par", "Pic"],
  "Boh": ["Mun", "Tyr", "Vie", "Gal", "Sil"],
  "Bud": ["Gal", "Rum", "Ser", "Tri", "Vie"],
  "Bul": ["Con", "Gre", "Rum", "Ser"],
  "Bur": ["Bel", "Gas", "Mar", "Mun", "Par", "Pic", "Ruh"],
  "Cly": ["Edi", "Lvp"],
  "Con": ["Ank", "Bul", "Smy"],
  "Den": ["Swe", "Kie"],
  "Edi": ["Cly", "Lvp", "Yor"],
  "Fin": ["Nwy", "Swe", "StP"],
  "Gal": ["War", "Sil", "Boh", "Vie", "Bud", "Rum", "Ukr"],
  "Gas": ["Bre", "Bur", "Mar", "Spa", "Par"],
  "Gre": ["Alb", "Bul", "Ser"],
  "Hol": ["Bel", "Kie", "Ruh"],
  "Kie": ["Ber", "Den", "Hol", "Mun", "Ruh"],
  "Lon": ["Wal", "Yor"],
  "Lvp": ["Cly", "Edi", "Wal", "Yor"],
  "Lvn": ["Pru", "War", "Mos", "StP"],
  "NAf": ["Tun"],
  "Mar": ["Bur", "Gas", "Pie", "Spa"],
  "Mos": ["Lvn", "Sev", "StP", "Ukr", "War"],
  "Mun": ["Ber", "Boh", "Bur", "Kie", "Ruh", "Sil", "Tyr"],
  "Nap": ["Apu", "Rom"],
  "Nwy": ["Fin", "StP", "Swe"],
  "Par": ["Bre", "Pic", "Bur", "Gas"],
  "Pie": ["Mar", "Tus", "Tyr", "Ven"],
  "Pic": ["Bel", "Bre", "Bur", "Par"],
  "Por": ["Spa"],
  "Pru": ["Ber", "Lvn", "Sil", "War"],
  "Rom": ["Apu", "Nap", "Tus", "Ven"],
  "Ruh": ["Bel", "Bur", "Hol", "Kie", "Mun"],
  "Rum": ["Bud", "Bul", "Gal", "Sev", "Ser", "Ukr"],
  "Ser": ["Alb", "Bud", "Bul", "Gre", "Rum", "Tri"],
  "Sev": ["Arm", "Mos", "Rum", "Ukr"],
  "Sil": ["Boh", "Gal", "Ber", "Mun", "Pru", "War"],
  "Smy": ["Ank", "Arm", "Con", "Syr"],
  "Spa": ["Gas", "Mar", "Por"],
  "StP": ["Nwy", "Fin", "Lvn", "Mos"],
  "Syr": ["Smy", "Arm"],
  "Swe": ["Nwy", "Fin", "Den"],
  "Tri": ["Alb", "Bud", "Tyr", "Ser", "Ven", "Vie"],
  "Tun": ["NAf"],
  "Tus": ["Pie", "Rom", "Ven"],
  "Tyr": ["Boh", "Mun", "Pie", "Tri", "Ven", "Vie"],
  "Ukr": ["Gal", "Mos", "Rum", "Sev", "War"],
  "Ven": ["Apu", "Pie", "Rom", "Tyr", "Tus", "Tri"],
  "Vie": ["Boh", "Bud", "Gal", "Tri", "Tyr"],
  "Wal": ["Lon", "Lvp", "Yor"],
  "War": ["Lvn", "Pru", "Sil", "Gal", "Ukr", "Mos"],
  "Yor": ["Edi", "Lon", "Lvp", "Wal"],
};

export const UNIT_LOC_MAP: Record<
  Partial<ProvinceCode>,
  { X: number; Y: number }
> = {
  "Adr": {
    "X": 793.5,
    "Y": 1048,
  },
  "Aeg": {
    "X": 1043.5,
    "Y": 1230,
  },
  "Alb": {
    "X": 906.5,
    "Y": 1113,
  },
  "Ank": {
    "X": 1301.5,
    "Y": 1110,
  },
  "Apu": {
    "X": 791.5,
    "Y": 1106,
  },
  "Arm": {
    "X": 1484.5,
    "Y": 1090,
  },
  "Bal": {
    "X": 878.5,
    "Y": 610,
  },
  "Bar": {
    "X": 1162.5,
    "Y": 73,
  },
  "Bel": {
    "X": 561.5,
    "Y": 753,
  },
  "Ber": {
    "X": 771.5,
    "Y": 690,
  },
  "Bla": {
    "X": 1233.5,
    "Y": 1000,
  },
  "Boh": {
    "X": 806.5,
    "Y": 814,
  },
  "Bot": {
    "X": 941.5,
    "Y": 485,
  },
  "Bre": {
    "X": 404.5,
    "Y": 819,
  },
  "Bud": {
    "X": 950.5,
    "Y": 904,
  },
  "Bul": {
    "X": 1048.5,
    "Y": 1068,
  },
  "BulE": {
    "X": 1127,
    "Y": 1067,
  },
  "BulS": {
    "X": 1070,
    "Y": 1140,
  },
  "Bur": {
    "X": 559.5,
    "Y": 871,
  },
  "Cly": {
    "X": 436.5,
    "Y": 492,
  },
  "Con": {
    "X": 1145.5,
    "Y": 1137,
  },
  "Den": {
    "X": 703.5,
    "Y": 587,
  },
  "Eas": {
    "X": 1218.5,
    "Y": 1311,
  },
  "Edi": {
    "X": 473.5,
    "Y": 514,
  },
  "Eng": {
    "X": 394.5,
    "Y": 751,
  },
  "Fin": {
    "X": 988.5,
    "Y": 380,
  },
  "Gal": {
    "X": 999.5,
    "Y": 831,
  },
  "Gas": {
    "X": 422.5,
    "Y": 912,
  },
  "GoL": {
    "X": 556,
    "Y": 1060,
  },
  "Gre": {
    "X": 966.5,
    "Y": 1190,
  },
  "Hel": {
    "X": 651.5,
    "Y": 631,
  },
  "Hol": {
    "X": 596.5,
    "Y": 711,
  },
  "Ion": {
    "X": 846.5,
    "Y": 1286,
  },
  "Iri": {
    "X": 335.5,
    "Y": 661,
  },
  "Kie": {
    "X": 683.5,
    "Y": 701,
  },
  "Lon": {
    "X": 488.5,
    "Y": 675,
  },
  "Lvn": {
    "X": 1025.5,
    "Y": 567,
  },
  "Lvp": {
    "X": 450.5,
    "Y": 576,
  },
  // "GoL": {
  //   "X": 514.3,
  //   "Y": 1055,
  // },
  "Mid": {
    "X": 141.8,
    "Y": 835.3,
  },
  "Mar": {
    "X": 524.5,
    "Y": 975,
  },
  // "Mid": {
  //   "X": 126,
  //   "Y": 902,
  // },
  "Mos": {
    "X": 1200.5,
    "Y": 590,
  },
  "Mun": {
    "X": 693.5,
    "Y": 828,
  },
  "NAf": {
    "X": 325.5,
    "Y": 1281,
  },
  "NAt": {
    "X": 180.1,
    "Y": 288.2,
  },
  "Nap": {
    "X": 806.5,
    "Y": 1170,
  },
  // ["Nat": {
  //   "X": 238,
  //   "Y": 427,
  // },
  "Nrg": {
    "X": 605,
    "Y": 250,
  },
  "Nth": {
    "X": 553.5,
    "Y": 560,
  },
  // ["Nwg": {
  //   "X": 652.7,
  //   "Y": 181.8,
  // },
  "Nwy": {
    "X": 703.5,
    "Y": 410,
  },
  "Par": {
    "X": 488.5,
    "Y": 845,
  },
  "Pic": {
    "X": 523.5,
    "Y": 781,
  },
  "Pie": {
    "X": 630.5,
    "Y": 968,
  },
  "Por": {
    "X": 181.5,
    "Y": 1013,
  },
  "Pru": {
    "X": 865.5,
    "Y": 690,
  },
  "Rom": {
    "X": 731.5,
    "Y": 1102,
  },
  "Ruh": {
    "X": 636.5,
    "Y": 779,
  },
  "Rum": {
    "X": 1096.5,
    "Y": 967,
  },
  "Ser": {
    "X": 933.5,
    "Y": 1050,
  },
  "Sev": {
    "X": 1284.5,
    "Y": 845,
  },
  "Sil": {
    "X": 832.5,
    "Y": 769,
  },
  "Ska": {
    "X": 735.5,
    "Y": 518,
  },
  "Smy": {
    "X": 1253.5,
    "Y": 1210,
  },
  "Spa": {
    "X": 335.5,
    "Y": 1039,
  },
  "SpaN": {
    "X": 289,
    "Y": 965,
  },
  "SpaS": {
    "X": 291,
    "Y": 1166,
  },
  "StP": {
    "X": 1166.5,
    "Y": 405,
  },
  "StPN": {
    "X": 1218,
    "Y": 222,
  },
  "StPS": {
    "X": 1066,
    "Y": 487,
  },
  "Swe": {
    "X": 829.5,
    "Y": 459,
  },
  // ["Swi": {
  //   "X": 642,
  //   "Y": 928,
  // },
  "Syr": {
    "X": 1452.5,
    "Y": 1206,
  },
  "Tri": {
    "X": 825.5,
    "Y": 996,
  },
  "Tun": {
    "X": 622.5,
    "Y": 1300,
  },
  "Tus": {
    "X": 686.5,
    "Y": 1034,
  },
  "Tyn": {
    "X": 698.5,
    "Y": 1149.1,
  },
  "Tyr": {
    "X": 742.5,
    "Y": 904,
  },
  "Ukr": {
    "X": 1124.5,
    "Y": 800,
  },
  "Ven": {
    "X": 707.5,
    "Y": 994,
  },
  "Vie": {
    "X": 855.5,
    "Y": 864,
  },
  "Wal": {
    "X": 428.5,
    "Y": 658,
  },
  "War": {
    "X": 983.5,
    "Y": 740,
  },
  "Wes": {
    "X": 462.5,
    "Y": 1163,
  },
  "Yor": {
    "X": 492.5,
    "Y": 616,
  },
};

export function isSea(provinceCode: ProvinceCode) {
  return provinces[provinceCode].type == ProvinceType.Sea;
}

export function isLand(provinceCode: ProvinceCode) {
  return provinces[provinceCode].type == ProvinceType.Land;
}

export function isCoast(provinceCode: ProvinceCode) {
  return provinces[provinceCode].type == ProvinceType.Coast;
}

export function fleetToArmyBorder(province: ProvinceCode) {
  /* Normalizes only-fleet destinations, e.g.: BulS -> Bul, SpaN -> Spa, StPN -> StP */
  if (
    (["SpaN", "SpaS", "BulE", "BulS", "StPN", "StPS"] as ProvinceCode[])
      .includes(province)
  ) {
    return province.slice(0, -1) as ProvinceCode;
  }
  return province;
}

export function armyToFleetBorder(province: ProvinceCode) {
  if (
    province == "Spa" || province == "StP"
  ) {
    return [`${province}S`, `${province}N`] as ProvinceCode[];
  }
  if (
    province == "Bul"
  ) {
    return [`${province}S`, `${province}E`] as ProvinceCode[];
  }
  return [province] as ProvinceCode[];
}

export function isConvoyFromPossible(from: ProvinceCode, origin: ProvinceCode) {
  /* Verifies that convoy is possible from particular province (including Spa, StP, and Bul). E.g. isConvoyFromPossible("Bul", "Bla") => true */
  return armyToFleetBorder(from).some((prv) =>
    fleetBorders[prv]!.includes(
      origin,
    )
  );
}

export function isConvoyToPossible(origin: ProvinceCode, to: ProvinceCode) {
  /* Verifies that convoy is possible to a particular province (including Spa, StP, and Bul). E.g. isConvoyToPossible("Bla", "Bul") => true */
  return fleetBorders[origin]?.includes(
    fleetToArmyBorder(to),
  ) || false;
}
